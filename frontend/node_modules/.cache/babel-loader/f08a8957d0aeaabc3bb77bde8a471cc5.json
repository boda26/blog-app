{"ast":null,"code":"import { createAsyncThunk, createSlice, createAction } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { baseUrl } from \"../../../utils/baseURL\"; //Create Post action\n//action to redirect\n\nconst resetPost = createAction(\"category/reset\");\nexport const createpostAction = createAsyncThunk(\"post/created\", async (post, _ref) => {\n  var _getState;\n\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref;\n  console.log(post); //get user token\n\n  const user = (_getState = getState()) === null || _getState === void 0 ? void 0 : _getState.users;\n  const {\n    userAuth\n  } = user;\n  const config = {\n    headers: {\n      Authorization: `Bearer ${userAuth === null || userAuth === void 0 ? void 0 : userAuth.token}`\n    }\n  };\n\n  try {\n    var _post$category;\n\n    //http call\n    const formData = new FormData();\n    formData.append(\"title\", post === null || post === void 0 ? void 0 : post.title);\n    formData.append(\"description\", post === null || post === void 0 ? void 0 : post.description);\n    formData.append(\"category\", post === null || post === void 0 ? void 0 : (_post$category = post.category) === null || _post$category === void 0 ? void 0 : _post$category.la);\n    formData.append(\"image\", post === null || post === void 0 ? void 0 : post.image);\n    const {\n      data\n    } = await axios.post(`${baseUrl}/api/posts`, formData, config); //dispatch action\n\n    dispatch(resetPost());\n    return data;\n  } catch (error) {\n    var _error$response;\n\n    if (!(error !== null && error !== void 0 && error.response)) throw error;\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n  }\n}); //slice\n\nconst postSlice = createSlice({\n  name: \"post\",\n  initialState: {},\n  extraReducers: builder => {\n    builder.addCase(createpostAction.pending, (state, action) => {\n      state.loading = true;\n    });\n    builder.addCase(resetPost, (state, action) => {\n      state.isCreated = true;\n    });\n    builder.addCase(createpostAction.fulfilled, (state, action) => {\n      state.postCreated = action === null || action === void 0 ? void 0 : action.payload;\n      state.loading = false;\n      state.isCreated = false;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(createpostAction.rejected, (state, action) => {\n      var _action$payload, _action$error;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message;\n    });\n  }\n});\nexport default postSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","createAction","axios","baseUrl","resetPost","createpostAction","post","rejectWithValue","getState","dispatch","console","log","user","users","userAuth","config","headers","Authorization","token","formData","FormData","append","title","description","category","la","image","data","error","response","postSlice","name","initialState","extraReducers","builder","addCase","pending","state","action","loading","isCreated","fulfilled","postCreated","payload","appErr","undefined","serverErr","rejected","message","reducer"],"sources":["/Users/bodasong/Desktop/blog/blog-frontend/src/redux/slices/posts/postSlices.js"],"sourcesContent":["import { createAsyncThunk, createSlice, createAction } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { baseUrl } from \"../../../utils/baseURL\";\n\n//Create Post action\n//action to redirect\nconst resetPost = createAction(\"category/reset\");\nexport const createpostAction = createAsyncThunk(\n  \"post/created\",\n  async (post, { rejectWithValue, getState, dispatch }) => {\n    console.log(post);\n    //get user token\n    const user = getState()?.users;\n    const { userAuth } = user;\n    const config = {\n      headers: {\n        Authorization: `Bearer ${userAuth?.token}`,\n      },\n    };\n    try {\n      //http call\n      const formData = new FormData();\n      formData.append(\"title\", post?.title);\n      formData.append(\"description\", post?.description);\n      formData.append(\"category\", post?.category?.la);\n      formData.append(\"image\", post?.image);\n\n      const { data } = await axios.post(\n        `${baseUrl}/api/posts`,\n        formData,\n        config\n      );\n      //dispatch action\n      dispatch(resetPost());\n      return data;\n    } catch (error) {\n      if (!error?.response) throw error;\n      return rejectWithValue(error?.response?.data);\n    }\n  }\n);\n\n//slice\n\nconst postSlice = createSlice({\n  name: \"post\",\n  initialState: {},\n  extraReducers: builder => {\n    builder.addCase(createpostAction.pending, (state, action) => {\n      state.loading = true;\n    });\n    builder.addCase(resetPost, (state, action) => {\n      state.isCreated = true;\n    });\n    builder.addCase(createpostAction.fulfilled, (state, action) => {\n      state.postCreated = action?.payload;\n      state.loading = false;\n      state.isCreated = false;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(createpostAction.rejected, (state, action) => {\n      state.loading = false;\n      state.appErr = action?.payload?.message;\n      state.serverErr = action?.error?.message;\n    });\n  },\n});\n\nexport default postSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}