{"ast":null,"code":"import { createAsyncThunk, createSlice, createAction } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { baseUrl } from '../../../utils/baseURL'; //custom action for redirect\n\nconst resetEmailAction = createAction(\"mail/reset\"); //action\n\nexport const sendMailAction = createAsyncThunk('mail/sent', async (email, _ref) => {\n  var _getState;\n\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref;\n  //get user token\n  const user = (_getState = getState()) === null || _getState === void 0 ? void 0 : _getState.users;\n  const {\n    userAuth\n  } = user;\n  const config = {\n    headers: {\n      Authorization: `Bearer ${userAuth === null || userAuth === void 0 ? void 0 : userAuth.token}`\n    }\n  }; //http call\n\n  try {\n    const {\n      data\n    } = await axios.post(`${baseUrl}/api/email`, {\n      to: email === null || email === void 0 ? void 0 : email.recipientEmail,\n      subject: email === null || email === void 0 ? void 0 : email.subject,\n      message: email === null || email === void 0 ? void 0 : email.message\n    }, config);\n    dispatch(resetEmailAction);\n    return data;\n  } catch (error) {\n    var _error$response;\n\n    if (!(error !== null && error !== void 0 && error.response)) {\n      throw error;\n    }\n\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n  }\n}); //slices\n\nconst sendMailSlices = createSlice({\n  name: 'mail',\n  initialState: {},\n  extraReducers: builder => {\n    //create\n    builder.addCase(sendMailAction.pending, (state, action) => {\n      state.loading = true;\n    }); //dispatch redirect action\n\n    builder.addCase(resetEmailAction, (state, action) => {\n      state.isMailSent = true;\n    });\n    builder.addCase(sendMailAction.fulfilled, (state, action) => {\n      state.mailSent = action === null || action === void 0 ? void 0 : action.payload;\n      state.loading = false;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n      state.isMailSent = false;\n    });\n    builder.addCase(sendMailAction.rejected, (state, action) => {\n      var _action$payload, _action$error;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message;\n    });\n  }\n});\nexport default sendMailSlices.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","createAction","axios","baseUrl","resetEmailAction","sendMailAction","email","rejectWithValue","getState","dispatch","user","users","userAuth","config","headers","Authorization","token","data","post","to","recipientEmail","subject","message","error","response","sendMailSlices","name","initialState","extraReducers","builder","addCase","pending","state","action","loading","isMailSent","fulfilled","mailSent","payload","appErr","undefined","serverErr","rejected","reducer"],"sources":["/Users/bodasong/Desktop/blog/blog-frontend/src/redux/slices/email/emailSlices.js"],"sourcesContent":["import {createAsyncThunk, createSlice, createAction} from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { baseUrl } from '../../../utils/baseURL';\n\n//custom action for redirect\nconst resetEmailAction = createAction(\"mail/reset\");\n\n//action\nexport const sendMailAction = createAsyncThunk(\n    'mail/sent',\n    async (email, {rejectWithValue, getState, dispatch}) => {\n        //get user token\n        const user = getState()?.users;\n        const {userAuth} = user;\n        const config = {\n            headers: {\n                Authorization: `Bearer ${userAuth?.token}`,\n            },\n        }\n        //http call\n        try {\n            const {data} = await axios.post(`${baseUrl}/api/email`, {\n                to: email?.recipientEmail,\n                subject: email?.subject,\n                message: email?.message,\n            },\n            config\n            );\n            dispatch(resetEmailAction);\n            return data;\n        } catch (error) {\n            if (!error?.response) {\n                throw error;\n            }\n            return rejectWithValue(error?.response?.data);\n        }\n    }\n);\n\n//slices\nconst sendMailSlices = createSlice({\n    name: 'mail',\n    initialState: {},\n    extraReducers: (builder)=> {\n        //create\n        builder.addCase(sendMailAction.pending, (state, action) => {\n            state.loading = true;\n        });\n        //dispatch redirect action\n        builder.addCase(resetEmailAction, (state, action) => {\n            state.isMailSent = true;\n        });\n        builder.addCase(sendMailAction.fulfilled, (state, action)=> {\n            state.mailSent = action?.payload;\n            state.loading = false;\n            state.appErr = undefined;\n            state.serverErr = undefined;\n            state.isMailSent = false;\n        });\n        builder.addCase(sendMailAction.rejected, (state, action)=> {\n            state.loading = false;\n            state.appErr = action?.payload?.message;\n            state.serverErr = action?.error?.message;\n        });\n    }\n});\n\nexport default sendMailSlices.reducer;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}